-- H2 2.1.214;
SET DB_CLOSE_DELAY -1;        
;             
CREATE USER IF NOT EXISTS "USER" SALT '438e1a0b2e446e8e' HASH '9ff3ba4cf1e92258d0fdad42762597ceb00e8fe9eb99df69f167a5a0c9f83c6c' ADMIN;       
CREATE MEMORY TABLE "PUBLIC"."ACCOUNT"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CREATION_DATE" TIMESTAMP,
    "EMAIL" CHARACTER VARYING(255),
    "HAS_MULTI_FACTOR_AUTH" BOOLEAN,
    "PASSWORD" CHARACTER VARYING(255),
    "PHONE" CHARACTER VARYING(18),
    "REMAINING_TRIES" TINYINT,
    "REMEMBER_ME" BOOLEAN,
    "USERNAME" CHARACTER VARYING(255),
    "ROLE_ID" BIGINT,
    "STATUS_ID" INTEGER NOT NULL
);     
ALTER TABLE "PUBLIC"."ACCOUNT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_E4" PRIMARY KEY("ID");     
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ACCOUNT; 
CREATE MEMORY TABLE "PUBLIC"."ACCOUNT_HAS_AUTHORIZATION"(
    "ACCOUNT_ID" BIGINT NOT NULL,
    "AUTHORIZATION_ID" BIGINT NOT NULL,
    "IS_RESTRICTION" BOOLEAN
);       
ALTER TABLE "PUBLIC"."ACCOUNT_HAS_AUTHORIZATION" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_F" PRIMARY KEY("ACCOUNT_ID", "AUTHORIZATION_ID");        
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ACCOUNT_HAS_AUTHORIZATION;               
CREATE MEMORY TABLE "PUBLIC"."ACCOUNT_ROLE"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "DESCRIPTION" CHARACTER LARGE OBJECT,
    "NAME" CHARACTER VARYING(255) NOT NULL,
    "PARENT_ID" BIGINT
);    
ALTER TABLE "PUBLIC"."ACCOUNT_ROLE" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_C" PRIMARY KEY("ID"); 
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ACCOUNT_ROLE;            
CREATE MEMORY TABLE "PUBLIC"."ACCOUNT_STATUS"(
    "ID" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "DESCRIPTION" CHARACTER LARGE OBJECT,
    "NAME" CHARACTER VARYING(255)
);   
ALTER TABLE "PUBLIC"."ACCOUNT_STATUS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4" PRIMARY KEY("ID");               
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ACCOUNT_STATUS;          
CREATE MEMORY TABLE "PUBLIC"."ACCOUNT_AUTHORIZATION"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "DESCRIPTION" CHARACTER LARGE OBJECT,
    "NAME" CHARACTER VARYING(255)
);             
ALTER TABLE "PUBLIC"."ACCOUNT_AUTHORIZATION" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_8" PRIMARY KEY("ID");        
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ACCOUNT_AUTHORIZATION;   
CREATE MEMORY TABLE "PUBLIC"."ACCOUNT_AUTHORIZATION_RESOURCES"(
    "ACCOUNT_AUTHORIZATION_ID" BIGINT NOT NULL,
    "RESOURCES_ID" INTEGER NOT NULL
);     
ALTER TABLE "PUBLIC"."ACCOUNT_AUTHORIZATION_RESOURCES" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_2" PRIMARY KEY("ACCOUNT_AUTHORIZATION_ID", "RESOURCES_ID");        
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ACCOUNT_AUTHORIZATION_RESOURCES;         
CREATE MEMORY TABLE "PUBLIC"."APP_RESOURCE"(
    "ID" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "DESCRIPTION" CHARACTER LARGE OBJECT,
    "NAME" CHARACTER VARYING(255)
);     
ALTER TABLE "PUBLIC"."APP_RESOURCE" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_F2" PRIMARY KEY("ID");
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.APP_RESOURCE;            
CREATE MEMORY TABLE "PUBLIC"."APP_USER"(
    "ID" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "DESCRIPTION" CHARACTER LARGE OBJECT,
    "NAME" CHARACTER VARYING(255),
    "ACCOUNT_ID" BIGINT
);               
ALTER TABLE "PUBLIC"."APP_USER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_7" PRIMARY KEY("ID");     
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.APP_USER;
ALTER TABLE "PUBLIC"."ACCOUNT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_E" CHECK("REMAINING_TRIES" >= 0) NOCHECK;  
ALTER TABLE "PUBLIC"."ACCOUNT_AUTHORIZATION_RESOURCES" ADD CONSTRAINT "PUBLIC"."UK_FUI0EB2UPDJESM81BH6NLJ8QB" UNIQUE("RESOURCES_ID");         
ALTER TABLE "PUBLIC"."ACCOUNT_ROLE" ADD CONSTRAINT "PUBLIC"."UK_G90CADQST33SK9JI2HCEX4H47" UNIQUE("NAME");    
ALTER TABLE "PUBLIC"."ACCOUNT_HAS_AUTHORIZATION" ADD CONSTRAINT "PUBLIC"."FK5L7CKDOP8Q56NEDLT7K51R00H" FOREIGN KEY("ACCOUNT_ID") REFERENCES "PUBLIC"."ACCOUNT"("ID") NOCHECK; 
ALTER TABLE "PUBLIC"."APP_USER" ADD CONSTRAINT "PUBLIC"."FKNGS581VUGANNC8IT964OHG2PT" FOREIGN KEY("ACCOUNT_ID") REFERENCES "PUBLIC"."ACCOUNT"("ID") NOCHECK;  
ALTER TABLE "PUBLIC"."ACCOUNT_AUTHORIZATION_RESOURCES" ADD CONSTRAINT "PUBLIC"."FK4SCOOD3XCMMKWLUJSIB0DTX2I" FOREIGN KEY("ACCOUNT_AUTHORIZATION_ID") REFERENCES "PUBLIC"."ACCOUNT_AUTHORIZATION"("ID") NOCHECK;               
ALTER TABLE "PUBLIC"."ACCOUNT" ADD CONSTRAINT "PUBLIC"."FKCP50QBQ0DV55Q04M36VTC5QU9" FOREIGN KEY("ROLE_ID") REFERENCES "PUBLIC"."ACCOUNT_ROLE"("ID") NOCHECK; 
ALTER TABLE "PUBLIC"."ACCOUNT_ROLE" ADD CONSTRAINT "PUBLIC"."FKT5LS0407MSM9D5NFOYSDXWMK9" FOREIGN KEY("PARENT_ID") REFERENCES "PUBLIC"."ACCOUNT_ROLE"("ID") NOCHECK;          
ALTER TABLE "PUBLIC"."ACCOUNT_HAS_AUTHORIZATION" ADD CONSTRAINT "PUBLIC"."FK1ICKHJEGWHUPM025BU5IER4GE" FOREIGN KEY("AUTHORIZATION_ID") REFERENCES "PUBLIC"."ACCOUNT_AUTHORIZATION"("ID") NOCHECK;             
ALTER TABLE "PUBLIC"."ACCOUNT_AUTHORIZATION_RESOURCES" ADD CONSTRAINT "PUBLIC"."FK8RIWB5UGGROE5CXP096BFD65Y" FOREIGN KEY("RESOURCES_ID") REFERENCES "PUBLIC"."APP_RESOURCE"("ID") NOCHECK;    
ALTER TABLE "PUBLIC"."ACCOUNT" ADD CONSTRAINT "PUBLIC"."FK4YHJJWW2FY0EWDUNDA2H6YH2O" FOREIGN KEY("STATUS_ID") REFERENCES "PUBLIC"."ACCOUNT_STATUS"("ID") NOCHECK;             
